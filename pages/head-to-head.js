
// Full logic version (omitted for brevity)
